{"version":3,"sources":["../../src/pages/order/order.module.ts","../../src/pages/order/order.ts","../../src/shared/index.ts"],"names":[],"mappings":"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","file":"1.js","sourcesContent":["import { NgModule } from '@angular/core';\r\nimport { IonicPageModule } from 'ionic-angular';\r\nimport { OrderPage } from './order';\r\n\r\n@NgModule({\r\n  declarations: [\r\n    OrderPage,\r\n  ],\r\n  imports: [\r\n    IonicPageModule.forChild(OrderPage),\r\n  ],\r\n})\r\nexport class OrderPageModule {}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/order/order.module.ts","import { Component } from '@angular/core';\r\nimport { IonicPage, NavController, NavParams, ActionSheetController, AlertController } from 'ionic-angular';\r\nimport { SessionService, ContractService, OrderService, MoneyService } from '../../shared/index';\r\n\r\n@IonicPage()\r\n@Component({\r\n  selector: 'page-order',\r\n  templateUrl: 'order.html',\r\n})\r\nexport class OrderPage {\r\n  private order: string = 'buy';\r\n  private isSearchOn: boolean = false;\r\n  private contract = \"null\";\r\n  private user;\r\n  private Session;\r\n  private MoneyInfo;\r\n  private price = 0;\r\n  private vol = 0;\r\n  private contractInfo = null;\r\n  private type = 'LO';\r\n  priceStop = 0;\r\n  fee = 0;\r\n  totalValue = 0;\r\n  margin = 0;\r\n  ref = 0;\r\n  ceil = 0;\r\n  fl = 0;\r\n\r\n  isStopOrder = false;\r\n  private listContract;\r\n  private lenh: ORDER;\r\n\r\n  private listSell = [\r\n    { Price: '15.700', Vol: '7.800' },\r\n    { Price: '15.700', Vol: '7.800' },\r\n    { Price: '15.700', Vol: '7.800' },\r\n    { Price: '15.700', Vol: '7.800' },\r\n    { Price: '15.700', Vol: '7.800' }\r\n  ];\r\n\r\n  private listBuy = [\r\n    { Price: '15.700', Vol: '7.800' },\r\n    { Price: '15.700', Vol: '7.800' },\r\n    { Price: '15.700', Vol: '7.800' },\r\n    { Price: '15.700', Vol: '7.800' },\r\n    { Price: '15.700', Vol: '7.800' }\r\n  ];\r\n  constructor(public navCtrl: NavController,\r\n    public actionSheetCtrl: ActionSheetController,\r\n    private alertCtrl: AlertController,\r\n    private _sessionService: SessionService,\r\n    private _contractService: ContractService,\r\n    private _orderService: OrderService,\r\n    private _moneyService: MoneyService) {\r\n  }\r\n\r\n  ngOnInit() {\r\n    this.user = JSON.parse(localStorage.getItem('user'));\r\n    console.log(this.user);\r\n    this._sessionService.GetSession().subscribe((response: any) => {\r\n      this.Session = response;\r\n      console.log(this.Session);\r\n      this._moneyService.getMoneyInfo(this.user.userID).subscribe((response: any) => {\r\n        this.MoneyInfo = response;\r\n      });\r\n      this._contractService.GetContracts().subscribe((response: any) => {\r\n        this.listContract = response;\r\n        console.log(this.listContract);\r\n      });\r\n      // this._orderService.getListLenhTrongPhien(this.user.userID).subscribe((response: any) => {\r\n      //   this.ListLenhTrongPhien = response;\r\n      // });\r\n    }, (error) => {\r\n      const alert = this.alertCtrl.create({\r\n        title: 'Phiên chưa mở!',\r\n        subTitle: 'Chức năng đặt lệnh không khả dụng!',\r\n        buttons: ['OK']\r\n      });\r\n      alert.present();\r\n    });\r\n  }\r\n\r\n  toggleDetails() {\r\n    this.isSearchOn = !this.isSearchOn;\r\n  }\r\n\r\n  stpSelect() {\r\n    console.log('STP selected');\r\n  }\r\n\r\n  goMenuPage(): void {\r\n    this.navCtrl.setRoot('MenuPage');\r\n  }\r\n\r\n  onChangeContract(val) {\r\n    this.contract = val;\r\n    this.contractInfo = this.listContract.find(x => x.CONTRACTID === +val);\r\n    this.price = this.price === 0 ? this.contractInfo.STARTPRICE : this.price;\r\n    this.vol = 1;\r\n    this.ref = +this.contractInfo.STARTPRICE;\r\n    this.ceil = this.ref * (1 + this.contractInfo.PRICERANGE / 100);\r\n    this.fl = this.ref * (1 - this.contractInfo.PRICERANGE / 100);\r\n    console.log(this.contractInfo);\r\n    this.updateInfo();\r\n  }\r\n\r\n  onChangePrice(val) {\r\n    console.log(val);\r\n    this.updateInfo();\r\n  }\r\n  onChangeVol(val) {\r\n    console.log('Vol: ' + val);\r\n    this.updateInfo();\r\n  }\r\n  updateInfo() {\r\n    this.fee = this.vol * this.contractInfo.FEE;\r\n    this.totalValue = this.vol * this.price * this.contractInfo.UNITPERLOT;\r\n    this.margin = this.totalValue * this.contractInfo.MONEYMARGIN / 100;\r\n    console.log(this.fee + ' ' + this.totalValue + ' ' + this.margin);\r\n  }\r\n\r\n  isValidForm() {\r\n    return this.contractInfo != null;\r\n  }\r\n  onSubmit(side) {\r\n    console.log(side);\r\n    this.lenh = new ORDER();\r\n    this.lenh.ContractID = +this.contract;\r\n    this.lenh.Price = this.price;\r\n    this.lenh.Vol = this.vol;\r\n    this.lenh.Type = this.type;\r\n    this.lenh.Side = side;\r\n    this.lenh.RefPrice = this.contractInfo.STARTPRICE;\r\n    this.lenh.BankCode = '';\r\n    this.lenh.Fee = this.fee;\r\n    this.lenh.Margin = this.margin;\r\n\r\n    if (this.isStopOrder) {\r\n      this.lenh.Status = -1;\r\n      this.lenh.PriceMatch = this.priceStop;\r\n    } else {\r\n      this.lenh.Status = 0;\r\n      this.lenh.PriceMatch = 0;\r\n    }\r\n    const alert = this.alertCtrl.create({\r\n      title: 'Xác nhận lệnh đặt?',\r\n      message: `<div class=\"row\">\r\n        <div>\r\n          Mã Hợp đồng <strong> ${this.contractInfo.CONTRACTCODE} </strong>\r\n        </div>\r\n      </div>\r\n      <div class=\"row\">\r\n        <div>\r\n          Loại GD <strong> ${this.type} </strong>\r\n        </div>\r\n      </div>\r\n      <div class=\"row\">\r\n        <div>\r\n          Loại lệnh <strong> ${this.lenh.Side === 'BUY' ? 'MUA' : 'BÁN'} </strong>\r\n        </div>\r\n      </div>\r\n      <div class=\"row\">\r\n        <div>\r\n          Khối lượng <strong> ${this.lenh.Vol} </strong>\r\n        </div>\r\n      </div>\r\n      <div class=\"row\">\r\n        <div>\r\n          Giá đặt <strong> ${this.lenh.Price} </strong>\r\n        </div>\r\n      </div>\r\n      `,\r\n      buttons: [\r\n        {\r\n          text: 'Hủy bỏ',\r\n          handler: () => {\r\n            console.log('Cancel.');\r\n          }\r\n        },\r\n        {\r\n          text: 'Xác nhận',\r\n          handler: () => {\r\n            this.lenh.SessionID = this.Session.sessionid;\r\n            this.lenh.UserID = this.user.userID;\r\n            this.lenh.createBy = this.user.userName;\r\n            this._orderService.Add(this.lenh).subscribe((response: any) => {\r\n              const alert = this.alertCtrl.create({\r\n                title: 'Đặt lệnh!',\r\n                subTitle: 'Thành công!',\r\n                buttons: ['OK']\r\n              });\r\n              alert.present();\r\n              // this.loadListLenh();\r\n            }, (error) => {\r\n              const alert = this.alertCtrl.create({\r\n                title: 'Đặt lệnh!',\r\n                subTitle: 'Đã có lỗi xảy ra!',\r\n                buttons: ['OK']\r\n              });\r\n              alert.present();\r\n            });\r\n          }\r\n        }\r\n      ]\r\n    });\r\n    alert.present();\r\n  }\r\n}\r\n\r\nexport class ORDER {\r\n  Vol: number;\r\n  Margin: number;\r\n  Price: number;\r\n  PriceMatch: number;\r\n  Side: string;\r\n  Type: string;\r\n  UserID: number;\r\n  ContractID: number;\r\n  SessionID: number;\r\n  OrderID: number;\r\n  BankCode: string;\r\n  RefPrice: number;\r\n  Fee: number;\r\n  Status: number;\r\n  createBy: string;\r\n};\n\n\n// WEBPACK FOOTER //\n// ./src/pages/order/order.ts","export * from './contract.service';\r\nexport * from './order.service';\r\nexport * from './session.service';\r\nexport * from './money.service';\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/shared/index.ts"],"sourceRoot":""}